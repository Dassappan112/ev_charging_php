{% extends 'main.twig' %}
{% block content %}

<style>
  .search-pane {
    border-right: 1px solid #ddd;
    padding-right: 20px;
  }

  .result-card {
    margin-bottom: 20px;
  }

  .result-card img {
    height: 200px;
    object-fit: cover;
  }

  .filter-title {
    margin-top: 20px;
  }
</style>


<div class="container-fluid">
  <div class="row">
    <!-- Left Pane: Search Filters -->
    <aside class="col-md-4 search-pane">
      <h2 class="filter-title">Search Filters</h2>

      <div class="mb-4">
        <label for="location" class="form-label">Location</label>
        <input type="text" class="form-control" id="location" placeholder="Enter location" />
      </div>

      <div class="mb-4">
        <label for="capacity" class="form-label">Charging Capacity</label>
        <select id="capacity" class="form-select">
          <option value="">Any</option>
          <option value="fast">Fast Charging</option>
          <option value="standard">Standard Charging</option>
        </select>
      </div>

      <div class="mb-4">
        <label for="other" class="form-label">Other Filters</label>
        <input type="text" class="form-control" id="other" placeholder="Additional filters" />
      </div>

      <button class="btn btn-success">Search</button>
    </aside>

    <!-- Right Pane: Search Results -->
    <main class="col-md-8">
      <h2 class="filter-title">Search Results</h2>
      <div id="stations">
      </div>
    </main>
  </div>
</div>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const token = localStorage.getItem('access_token');
    fetch('{{api_host}}/api/charge-stations/', {
      method: 'GET',
      headers: {
        'Content-Type': 'application/json',
        Authorization: `Bearer ${token}`,
      }
    })
      .then(response => response.json())
      .then(data => {
        const resultsContainer = document.getElementById('stations');
        data.forEach(station => {
          const card = document.createElement('div');
          card.className = 'card result-card';
          card.innerHTML = `
            <img src="${station.banner}" class="card-img-top" alt="Charging Station" />
            <div class="card-body">
              <h5 class="card-title">${station.name}</h5>
              <p class="card-text"><strong>Location:</strong> ${station.address}</p>
              <p class="card-text">${station.description}</p>
              <p class="card-text">
                <strong>Contact:</strong> ${station.contact} | <a href="mailto:${station.email}">${station.email}</a>
              </p>
              <a href="/book/${station.id}" class="btn btn-success">Book Now</a>
            </div>
          `;
          resultsContainer.appendChild(card);
        });
        if (data.length === 0) {
          const noResultsMessage = document.createElement('p');
          noResultsMessage.textContent = 'No charging stations found.';
          resultsContainer.appendChild(noResultsMessage);
        }
      })
      .catch(error => console.error('Error fetching charge stations:', error));
  });
</script>

{% endblock content %}